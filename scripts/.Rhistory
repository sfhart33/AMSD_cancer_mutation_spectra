data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")) %>%
pivot_longer(cols = c(exp,nonexp))
pivot_longer?
m,
? pivot_longer
rbind(data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")) %>%
pivot_longer(cols = c(exp,nonexp), names_to = "exposure")
rbind(data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")) %>%
pivot_longer(cols = c(exp,nonexp), names_to = "group", values_to = "exposure")
rbind(data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")) %>%
pivot_longer(cols = c(exp,nonexp), names_to = "group", values_to = "exposure") %>%
mutate(sd = case_when(group == "exp" ~ exp_sd,
group == "nonexp" ~ nonexp_sd))
rbind(data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")) %>%
pivot_longer(cols = c(exp,nonexp), names_to = "group", values_to = "exposure") %>%
mutate(sd = case_when(group == "exp" ~ exp_sd,
group == "nonexp" ~ nonexp_sd)) %>%
select(-exp_sd, -nonexp_sd)
sig_comps <- rbind(data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature"),
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")) %>%
pivot_longer(cols = c(exp,nonexp), names_to = "group", values_to = "exposure") %>%
mutate(sd = case_when(group == "exp" ~ exp_sd,
group == "nonexp" ~ nonexp_sd)) %>%
select(-exp_sd, -nonexp_sd)
sig_comps
# compare signatures
asb_sigs
sigs_exp/rowSums(sigs_exp)
CN_f <- subset(asb_sigs, select=CN1:CN19)/rowSums(asb_sigs)
subset(asb_sigs, select=CN1:CN19)
CN_f <- subset(asb_sigs, select=CN1:CN19)/rowSums(subset(asb_sigs, select=CN1:CN19))
CN_f
rownames(subset(asb_sigs, select=CN1:CN19))
colnames(subset(asb_sigs, select=CN1:CN19))
paste0(colnames(subset(asb_sigs, select=CN1:CN19)), "_X")
CN_f <- subset(asb_sigs, select=CN1:CN19)/rowSums(subset(asb_sigs, select=CN1:CN19))
colnames(CN_f) <- paste0(colnames(subset(asb_sigs, select=CN1:CN19)), "_f")
cbind(asb_sigs, CN_f)
samples
select(samples, Sample, Professional.Asbestos)
asb_sigs2 <- cbind(asb_sigs, CN_f)
asb_sigs2
select(samples, Sample, Professional.Asbestos)
asb_sigs2 <- cbind(asb_sigs, CN_f) %>%
left_join(select(samples, Sample, Professional.Asbestos))
asb_sigs2 <- cbind(asb_sigs, CN_f) %>%
left_join(select(samples, sample = Sample, Professional.Asbestos))
asb_sigs2
asb_sigs2 <- cbind(asb_sigs, CN_f) %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos)))
asb_sigs2
asb_sigs2 <- cbind(asb_sigs, CN_f) %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam)
asb_sigs2
CN_f
asb_sigs2 <- asb_sigs %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam)
asb_sigs2
asb_sigs2 <- asb_sigs %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam) %>%
pivot_longer(cols = c("CN1","CN2","CN5"))
asb_sigs2
asb_sigs2 <- asb_sigs %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam) %>%
pivot_longer(cols = c("CN1","CN2","CN5","CN9","CN15","CN18,"CN19""))
asb_sigs2 <- asb_sigs %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam) %>%
pivot_longer(cols = c("CN1","CN2","CN5","CN9","CN15","CN18","CN19"))
asb_sigs2
sig_counts <- asb_sigs %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam) %>%
pivot_longer(cols = c("CN1","CN2","CN5","CN9","CN15","CN18","CN19"))
sig_freqs <- cbind(asb_sigs, CN_f) %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1_f:sam) %>%
pivot_longer(cols = c("CN1_f","CN2_f","CN5_f","CN9_f","CN15_f","CN18_f","CN19_f"))
sig_counts
sig_freqs
sig_counts2 <- sig_counts %>%
filter(!(sam %in% c("MESO_007_T", "MESO_107_T")))%>%
mutate(run = "sumNO")
rbind(sig_freqs, sig_counts, sig_counts2)
sig_freqs
sig_counts <- asb_sigs %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1:sam) %>%
pivot_longer(cols = c("CN1","CN2","CN5","CN9","CN15","CN18","CN19")) %>%
mutate(run = "sum")
sig_freqs <- cbind(asb_sigs, CN_f) %>%
left_join(select(samples, sample = Sample, Professional.Asbestos)) %>%
filter(!(is.na(Professional.Asbestos))) %>%
mutate(sam = sample) %>%
subset(select=CN1_f:sam) %>%
pivot_longer(cols = c("CN1_f","CN2_f","CN5_f","CN9_f","CN15_f","CN18_f","CN19_f")) %>%
separate(name, into = c("name", NA)) %>%
mutate(run = "mean")
sig_counts2 <- sig_counts %>%
filter(!(sam %in% c("MESO_007_T", "MESO_107_T")))%>%
mutate(run = "sumNO")
rbind(sig_freqs, sig_counts, sig_counts2)
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Exposure")
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_grid(cols = vars(run))+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Exposure")
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_grid(cols = vars(run), scales = "free")+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Exposure")
sigs_exp <- filter(asb_sigs, sample %in% samples_exp) %>%
subset(select=CN1:CN19)
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_grid(cols = vars(run), scales = "free_y", independent = "y")+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Asbestos exposure")
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_grid(cols = vars(run), scales = "free_y")+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Asbestos exposure")
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_grid(~run, scales = "free_y")+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Asbestos exposure")
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_grid(. ~ run, scales = "free_y")+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Asbestos exposure")
rbind(sig_freqs, sig_counts, sig_counts2) %>%
ggplot(aes(x=name,y=value, color = Professional.Asbestos))+
geom_boxplot(outliers = FALSE)+
geom_point(position=position_jitterdodge(jitter.width = 0.1))+
scale_color_manual(values = c("grey", "black"))+
facet_wrap(. ~ run, scales = "free_y")+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="top",
legend.title = element_text(hjust = 0.5))+
guides(fill = guide_legend(title.position = "top"))+
labs(x = "Mutational signature",
y = "Signature fraction",
color = "Asbestos exposure")
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature"))
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature")
data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature")
data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(expB,nonexpB, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = expB-expB_sd, xmax = expB+expB_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexpB-nonexpB_sd, ymax = nonexpB+nonexpB_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
coord_cartesian(
xlim = c(0,0.6),
ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, sums,\nwith outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
coord_cartesian(
xlim = c(0,0.6),
ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, sums,\nwith outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
# coord_cartesian(
#   xlim = c(0,0.6),
#   ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, sums,\nwith outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
# coord_cartesian(
#   xlim = c(0,0.6),
#   ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, means,\nwith outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
# coord_cartesian(
#   xlim = c(0,0.6),
#   ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, sums,\nno outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
sig_plot1 <- data.frame(type = "means",
exp = colMeans(sigs_exp/rowSums(sigs_exp)),
nonexp = colMeans(sigs_nonexp/rowSums(sigs_nonexp)),
exp_sd = sapply(sigs_exp/rowSums(sigs_exp), sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp/rowSums(sigs_nonexp), sd)/sqrt(nrow(sigs_nonexp))) %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
# coord_cartesian(
#   xlim = c(0,0.6),
#   ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, means,\nwith outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
sig_plot2 <- data.frame(type = "sums",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp, sd)/sqrt(nrow( sigs_nonexp))) %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
# coord_cartesian(
#   xlim = c(0,0.6),
#   ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, sums,\nwith outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
sig_plot3 <- data.frame(type = "sums_NO",
exp = colMeans(sigs_exp),
nonexp = colMeans(sigs_nonexp_no_outlier),
exp_sd = sapply(sigs_exp, sd)/sqrt(nrow(sigs_exp)),
nonexp_sd = sapply(sigs_nonexp_no_outlier, sd)/sqrt(nrow(sigs_nonexp_no_outlier)))  %>%
rownames_to_column(var = "Signature") %>%
ggplot(aes(exp,nonexp, label = rownames(sigs_comp)))+
geom_point(size = 0.25)+
geom_pointrange(aes(xmin = exp-exp_sd, xmax = exp+exp_sd), size = 0.25)+
geom_pointrange(aes(ymin = nonexp-nonexp_sd, ymax = nonexp+nonexp_sd), size = 0.25)+
geom_abline(intercept = 0, slope = 1)+
geom_text(check_overlap = TRUE)+
# coord_cartesian(
#   xlim = c(0,0.6),
#   ylim = c(0,0.6))+
theme_classic()+
labs(title= "CNV signatures, sums,\nno outliers",
x = "Prof. exposed to asbestos",
y = "NOT prof. exp. to asbestos")
#
asbestos_fig <- ggarrange(p1,
p2,
high_outlier_plot,
p3,
p4,
p5,
sig_plot1,
sig_plot2,
sig_plot3,
nrow = 3,
ncol = 3,
labels = c("A", "B", "C", "D", "E", "F","G", "H", "I")
)
ggsave("../outputs/asbestos_supp_fig.png",
plot = asbestos_fig,
width = 7, height = 8, units = "in")
