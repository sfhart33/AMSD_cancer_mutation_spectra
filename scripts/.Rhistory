lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
plot_sig_means_clean <- function(anc1, anc2, tumor, tumor_name, signatures) {
# Subset results
subset_tcga <- all_results %>%
mutate(ancestries = paste0(ancestry1, "_v_", ancestry2)) %>%
filter(
tumor_type == tumor,
ancestries == paste0(anc1, "_v_", anc2),
measure == "fraction",
!is.na(p_value)
)
ggplot(subset_tcga, aes(x = mean1, y = mean2, label = signature)) +
geom_point() +
# Error bars for ancestry1 (x-axis)
geom_errorbarh(aes(xmin = mean1 - sd1/sqrt(n1), xmax = mean1 + sd1/sqrt(n1)),
height = 0, alpha = 0.5) +
# Error bars for ancestry2 (y-axis)
geom_errorbar(aes(ymin = mean2 - sd2/sqrt(n2), ymax = mean2 + sd2/sqrt(n2)),
width = 0, alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40") +
# geom_label_repel(max.overlaps = 20) +
ggrepel::geom_label_repel(
data = subset_tcga %>%
filter(signature %in% signatures),
aes(label = signature),
max.overlaps = 50,
box.padding = 0.5,
point.padding = 0.3,
min.segment.length = 0,
segment.curvature = 0.1,
segment.ncp = 3,
segment.angle = 20,
repel = TRUE
) +
labs(
title = tumor_name,
x = toupper(anc1),
y = toupper(anc2)
) +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
}
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
plot_sig_means_clean <- function(anc1, anc2, tumor, tumor_name, signatures) {
# Subset results
subset_tcga <- all_results %>%
mutate(ancestries = paste0(ancestry1, "_v_", ancestry2)) %>%
filter(
tumor_type == tumor,
ancestries == paste0(anc1, "_v_", anc2),
measure == "fraction",
!is.na(p_value)
)
ggplot(subset_tcga, aes(x = mean1, y = mean2, label = signature)) +
geom_point() +
# Error bars for ancestry1 (x-axis)
geom_errorbarh(aes(xmin = mean1 - sd1/sqrt(n1), xmax = mean1 + sd1/sqrt(n1)),
height = 0, alpha = 0.5) +
# Error bars for ancestry2 (y-axis)
geom_errorbar(aes(ymin = mean2 - sd2/sqrt(n2), ymax = mean2 + sd2/sqrt(n2)),
width = 0, alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40") +
# geom_label_repel(max.overlaps = 20) +
ggrepel::geom_label_repel(
data = subset_tcga %>%
filter(signature %in% signatures),
aes(label = signature),
avoid_points = TRUE,   # <—
box.padding = 0.5,
point.padding = 0.3,
force = 1,
force_pull = 0.1,
max.overlaps = 50,
min.segment.length = 0,
segment.color = "gray60"
) +
labs(
title = tumor_name,
x = toupper(anc1),
y = toupper(anc2)
) +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
}
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
ggplot(subset_tcga, aes(x = mean1, y = mean2, label = signature)) +
geom_point() +
# Error bars for ancestry1 (x-axis)
geom_errorbarh(aes(xmin = mean1 - sd1/sqrt(n1), xmax = mean1 + sd1/sqrt(n1)),
height = 0, alpha = 0.5) +
# Error bars for ancestry2 (y-axis)
geom_errorbar(aes(ymin = mean2 - sd2/sqrt(n2), ymax = mean2 + sd2/sqrt(n2)),
width = 0, alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40") +
# geom_label_repel(max.overlaps = 20) +
ggrepel::geom_label_repel(
data = subset_tcga %>%
filter(signature %in% signatures),
aes(label = signature),
avoid_points = TRUE,   # <—
box.padding = 0.5,
point.padding = 0.3,
force = 0.3,
force_pull = 0.1,
max.overlaps = 50,
min.segment.length = 0,
segment.color = "gray60"
) +
labs(
title = tumor_name,
x = toupper(anc1),
y = toupper(anc2)
) +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
plot_sig_means_clean <- function(anc1, anc2, tumor, tumor_name, signatures) {
# Subset results
subset_tcga <- all_results %>%
mutate(ancestries = paste0(ancestry1, "_v_", ancestry2)) %>%
filter(
tumor_type == tumor,
ancestries == paste0(anc1, "_v_", anc2),
measure == "fraction",
!is.na(p_value)
)
ggplot(subset_tcga, aes(x = mean1, y = mean2, label = signature)) +
geom_point() +
# Error bars for ancestry1 (x-axis)
geom_errorbarh(aes(xmin = mean1 - sd1/sqrt(n1), xmax = mean1 + sd1/sqrt(n1)),
height = 0, alpha = 0.5) +
# Error bars for ancestry2 (y-axis)
geom_errorbar(aes(ymin = mean2 - sd2/sqrt(n2), ymax = mean2 + sd2/sqrt(n2)),
width = 0, alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40") +
# geom_label_repel(max.overlaps = 20) +
ggrepel::geom_label_repel(
data = subset_tcga %>%
filter(signature %in% signatures),
aes(label = signature),
avoid_points = TRUE,   # <—
box.padding = 0.5,
point.padding = 0.3,
force = 0.3,
force_pull = 0.1,
max.overlaps = 50,
min.segment.length = 0,
segment.color = "gray60"
) +
labs(
title = tumor_name,
x = toupper(anc1),
y = toupper(anc2)
) +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
}
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
plot_sig_means_clean <- function(anc1, anc2, tumor, tumor_name, signatures) {
# Subset results
subset_tcga <- all_results %>%
mutate(ancestries = paste0(ancestry1, "_v_", ancestry2)) %>%
filter(
tumor_type == tumor,
ancestries == paste0(anc1, "_v_", anc2),
measure == "fraction",
!is.na(p_value)
)
ggplot(subset_tcga, aes(x = mean1, y = mean2, label = signature)) +
geom_point() +
# Error bars for ancestry1 (x-axis)
geom_errorbarh(aes(xmin = mean1 - sd1/sqrt(n1), xmax = mean1 + sd1/sqrt(n1)),
height = 0, alpha = 0.5) +
# Error bars for ancestry2 (y-axis)
geom_errorbar(aes(ymin = mean2 - sd2/sqrt(n2), ymax = mean2 + sd2/sqrt(n2)),
width = 0, alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40") +
# geom_label_repel(max.overlaps = 20) +
ggrepel::geom_label_repel(
data = subset_tcga %>%
filter(signature %in% signatures),
aes(label = signature),
avoid_points = TRUE,   # <—
box.padding = 0.5,
point.padding = 1,
force = 0.3,
force_pull = 0.1,
max.overlaps = 50,
min.segment.length = 0,
segment.color = "gray60"
) +
labs(
title = tumor_name,
x = toupper(anc1),
y = toupper(anc2)
) +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
}
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
plot_sig_means_clean <- function(anc1, anc2, tumor, tumor_name, signatures) {
# Subset results
subset_tcga <- all_results %>%
mutate(ancestries = paste0(ancestry1, "_v_", ancestry2)) %>%
filter(
tumor_type == tumor,
ancestries == paste0(anc1, "_v_", anc2),
measure == "fraction",
!is.na(p_value)
)
ggplot(subset_tcga, aes(x = mean1, y = mean2, label = signature)) +
geom_point() +
# Error bars for ancestry1 (x-axis)
geom_errorbarh(aes(xmin = mean1 - sd1/sqrt(n1), xmax = mean1 + sd1/sqrt(n1)),
height = 0, alpha = 0.5) +
# Error bars for ancestry2 (y-axis)
geom_errorbar(aes(ymin = mean2 - sd2/sqrt(n2), ymax = mean2 + sd2/sqrt(n2)),
width = 0, alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40") +
# geom_label_repel(max.overlaps = 20) +
ggrepel::geom_label_repel(
data = subset_tcga %>%
filter(signature %in% signatures),
aes(label = signature),
avoid_points = TRUE,   # <—
box.padding = 0.5,
point.padding = 1,
force = 1,
force_pull = 0.1,
max.overlaps = 50,
min.segment.length = 0,
segment.color = "gray60"
) +
labs(
title = tumor_name,
x = toupper(anc1),
y = toupper(anc2)
) +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
}
esca <- plot_sig_means_clean("eas", "eur", "ESCA", "Esophageal", c("SBS1", "SBS5", "SBS16","SBS17a", "SBS17b"))+
coord_flip()
lihc <- plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS5", "SBS16","SBS22", "SBS24"))+
coord_flip()
# plot_sig_means_clean("eas", "eur", "LIHC", "Liver", c("SBS1","SBS5", "SBS16","SBS22", "SBS24"))+
#   xlim(0,0.2)+ ylim(0,0.2)+ coord_flip()+
#   annotate("segment", x = 0.175, y = 0.18, xend = 0.195, yend = 0.2,
#            arrow = arrow(length = unit(0.02, "npc"))) +
#   annotate("label", x = 0.175, y = 0.18, label = "SBS5", hjust = 0.5, fill = "white")
lua1 <- plot_sig_means_clean("afr", "eas", "LUAD", "Lung Adeno.", c("SBS1", "SBS5", "SBS4", "SBS40"))+
coord_flip()
lua2 <- plot_sig_means_clean("afr", "eur", "LUAD", "Lung Adeno.", c("SBS5", "SBS4", "SBS40"))+
coord_flip()
uce1 <- plot_sig_means_clean("eas", "eur", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
uce2 <- plot_sig_means_clean("afr", "eas", "UCEC", "Uterine", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
coa1 <- plot_sig_means_clean("eas", "eur", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))+
coord_flip()
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
sig_plots <- ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
fig3 <- ggarrange(ancestry_volcano,
ggarrange(NULL,
sig_plots,
NULL,
ncol = 3,
widths = c(0.1,0.8,0.1)),
nrow = 2,
labels = c("A", "B"))
fig3
fig3 <- ggarrange(ancestry_volcano,
ggarrange(NULL,
sig_plots,
NULL,
ncol = 3,
widths = c(0.025,0.95,0.025)),
nrow = 2,
labels = c("A", "B"))
fig3
fig3 <- ggarrange(ancestry_volcano,
sig_plots,
# ggarrange(NULL,
#           sig_plots,
#           NULL,
#           ncol = 3,
#           widths = c(0.025,0.95,0.025)),
nrow = 2,
labels = c("A", "B"))
fig3
coa2 <- plot_sig_means_clean("afr", "eas", "COAD", "Colorectal", c("SBS1", "SBS5", "SBS10a", "SBS10b"))
sig_plots <- ggarrange(esca, lihc, lua1, lua2, uce1, uce2, coa1, coa2, nrow = 2, ncol = 4)
fig3 <- ggarrange(ancestry_volcano,
sig_plots,
# ggarrange(NULL,
#           sig_plots,
#           NULL,
#           ncol = 3,
#           widths = c(0.025,0.95,0.025)),
nrow = 2,
labels = c("A", "B"))
fig3
fig3 <- ggarrange(ancestry_volcano,
sig_plots,
# ggarrange(NULL,
#           sig_plots,
#           NULL,
#           ncol = 3,
#           widths = c(0.025,0.95,0.025)),
nrow = 2,
labels = c("A", "B"))
ggsave("../outputs/Figure3_revision.png",
plot = fig3,
width = 10,
height = 10,
units = "in")
ggsave("../outputs/Figure3_revision.svg",
plot = fig3,
width = 10,
height = 10,
units = "in")
fig3 <- ggarrange(ancestry_volcano,
sig_plots,
# ggarrange(NULL,
#           sig_plots,
#           NULL,
#           ncol = 3,
#           widths = c(0.025,0.95,0.025)),
nrow = 2,
widths = c(0.6,0.4),
labels = c("A", "B"))
ggsave("../outputs/Figure3_revision.png",
plot = fig3,
width = 10,
height = 10,
units = "in")
ggsave("../outputs/Figure3_revision.svg",
plot = fig3,
width = 10,
height = 10,
units = "in")
fig3 <- ggarrange(ancestry_volcano,
sig_plots,
# ggarrange(NULL,
#           sig_plots,
#           NULL,
#           ncol = 3,
#           widths = c(0.025,0.95,0.025)),
nrow = 2,
heights =  = c(0.6,0.4),
fig3 <- ggarrange(ancestry_volcano,
sig_plots,
# ggarrange(NULL,
#           sig_plots,
#           NULL,
#           ncol = 3,
#           widths = c(0.025,0.95,0.025)),
nrow = 2,
heights = c(0.6,0.4),
labels = c("A", "B"))
ggsave("../outputs/Figure3_revision.png",
plot = fig3,
width = 10,
height = 10,
units = "in")
ggsave("../outputs/Figure3_revision.svg",
plot = fig3,
width = 10,
height = 10,
units = "in")
all_results
all_results %>%
filter(measure == "fraction", tumor_type == "COAD", signature %in% c("SBS10a", "SBS10b"))
coa1
coa1
coa2
?cosmic_fit
